var xe=Object.defineProperty,Oe=Object.defineProperties;var He=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var Be=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable;var I=(e,t,n)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f=(e,t)=>{for(var n in t||(t={}))Be.call(t,n)&&I(e,n,t[n]);if(j)for(var n of j(t))Me.call(t,n)&&I(e,n,t[n]);return e},O=(e,t)=>Oe(e,He(t));import{p as Fe,Q as a,x as Ae,r as U,m as w,J,v as De,n as G,T as Re,o as re,z as ae,a1 as N,B as v,a2 as We}from"./index.520fd091.js";import{f as ze,u as Ke,h as Ve,v as Z,i as Xe,a as Ye,j as $e,b as Qe,k as _e,l as je,m as Ie,d as Ue,n as Je,p as ee,r as te,o as Ge,s as Ne,q as Ze,t as et}from"./position-engine.3538006d.js";import{u as tt,a as ot}from"./use-dark.133168d9.js";import{c as nt,f as it,l as st}from"./QIcon.acf7d2ae.js";import{g as lt,b as rt,a as at,h as ut}from"./scroll.a291fc9c.js";function kt(e,t,n){return n<=t?t:Math.min(n,Math.max(t,e))}function Ct(e,t,n){if(n<=t)return t;const i=n-t+1;let s=t+(e-t)%i;return s<t&&(s=i+s),s===0?0:s}const h=[];let p;function ct(e){p=e.keyCode===27}function dt(){p===!0&&(p=!1)}function ft(e){p===!0&&(p=!1,Fe(e,27)===!0&&h[h.length-1](e))}function ue(e){window[e]("keydown",ct),window[e]("blur",dt),window[e]("keyup",ft),p=!1}function vt(e){a.is.desktop===!0&&(h.push(e),h.length===1&&ue("addEventListener"))}function oe(e){const t=h.indexOf(e);t>-1&&(h.splice(t,1),h.length===0&&ue("removeEventListener"))}const m=[];function ce(e){m[m.length-1](e)}function ht(e){a.is.desktop===!0&&(m.push(e),m.length===1&&document.body.addEventListener("focusin",ce))}function mt(e){const t=m.indexOf(e);t>-1&&(m.splice(t,1),m.length===0&&document.body.removeEventListener("focusin",ce))}var qt=nt({name:"QMenu",inheritAttrs:!1,props:O(f(f(f(f({},ze),Ke),tt),Ve),{persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:Z},self:{type:String,validator:Z},offset:{type:Array,validator:Xe},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}}),emits:[...Ye,"click","escape-key"],setup(e,{slots:t,emit:n,attrs:i}){let s=null,r,l,S;const F=Ae(),{proxy:k}=F,{$q:u}=k,c=U(null),d=U(!1),de=w(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),fe=ot(e,u),{registerTick:ve,removeTick:A}=$e(),{registerTimeout:D,removeTimeout:R}=Qe(),{transition:he,transitionStyle:me}=_e(e,d),{localScrollTarget:W,changeScrollEvent:ge,unconfigureScrollTarget:we}=je(e,Q),{anchorEl:g,canShow:ye}=Ie({showing:d}),{hide:z}=Ue({showing:d,canShow:ye,handleShow:Ee,handleHide:Se,hideOnRouteChange:de,processOnMount:!0}),{showPortal:K,hidePortal:V,renderPortal:pe}=Je(F,c,Ce),C={anchorEl:g,innerRef:c,onClickOutside(o){if(e.persistent!==!0&&d.value===!0)return z(o),(o.type==="touchstart"||o.target.classList.contains("q-dialog__backdrop"))&&ae(o),!0}},X=w(()=>ee(e.anchor||(e.cover===!0?"center middle":"bottom start"),u.lang.rtl)),Te=w(()=>e.cover===!0?X.value:ee(e.self||"top start",u.lang.rtl)),be=w(()=>(e.square===!0?" q-menu--square":"")+(fe.value===!0?" q-menu--dark q-dark":"")),Pe=w(()=>e.autoClose===!0?{onClick:ke}:{}),Y=w(()=>d.value===!0&&e.persistent!==!0);J(Y,o=>{o===!0?(vt(L),et(C)):(oe(L),te(C))});function q(){Ze(()=>{let o=c.value;o&&o.contains(document.activeElement)!==!0&&(o=o.querySelector("[autofocus], [data-autofocus]")||o,o.focus({preventScroll:!0}))})}function Ee(o){if(A(),R(),s=e.noRefocus===!1?document.activeElement:null,ht(_),K(),Q(),r=void 0,o!==void 0&&(e.touchPosition||e.contextMenu)){const x=De(o);if(x.left!==void 0){const{top:qe,left:Le}=g.value.getBoundingClientRect();r={left:x.left-Le,top:x.top-qe}}}l===void 0&&(l=J(()=>u.screen.width+"|"+u.screen.height+"|"+e.self+"|"+e.anchor+"|"+u.lang.rtl,T)),e.noFocus!==!0&&document.activeElement.blur(),ve(()=>{T(),e.noFocus!==!0&&q()}),D(()=>{u.platform.is.ios===!0&&(S=e.autoClose,c.value.click()),T(),K(!0),n("show",o)},e.transitionDuration)}function Se(o){A(),R(),V(),$(!0),s!==null&&(o===void 0||o.qClickOutside!==!0)&&(s.focus(),s=null),D(()=>{V(!0),n("hide",o)},e.transitionDuration)}function $(o){r=void 0,l!==void 0&&(l(),l=void 0),(o===!0||d.value===!0)&&(mt(_),we(),te(C),oe(L)),o!==!0&&(s=null)}function Q(){(g.value!==null||e.scrollTarget!==void 0)&&(W.value=lt(g.value,e.scrollTarget),ge(W.value,T))}function ke(o){S!==!0?(Ge(k,o),n("click",o)):S=!1}function _(o){Y.value===!0&&e.noFocus!==!0&&st(c.value,o.target)!==!0&&q()}function L(o){n("escape-key"),z(o)}function T(){const o=c.value;o===null||g.value===null||Ne({el:o,offset:e.offset,anchorEl:g.value,anchorOrigin:X.value,selfOrigin:Te.value,absoluteOffset:r,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Ce(){return G(Re,{name:he.value,appear:!0},()=>d.value===!0?G("div",f(O(f({},i),{ref:c,tabindex:-1,class:["q-menu q-position-engine scroll"+be.value,i.class],style:[i.style,me.value]}),Pe.value),it(t.default)):null)}return re($),Object.assign(k,{focus:q,updatePosition:T}),pe}});function Lt(e,t,n){let i;function s(){i!==void 0&&(N.remove(i),i=void 0)}return re(()=>{e.value===!0&&s()}),{removeFromHistory:s,addToHistory(){i={condition:()=>n.value===!0,handler:t},N.add(i)}}}let b=0,H,B,P,M=!1,ne,ie,y;function gt(e){wt(e)&&ae(e)}function wt(e){if(e.target===document.body||e.target.classList.contains("q-layout__backdrop"))return!0;const t=We(e),n=e.shiftKey&&!e.deltaX,i=!n&&Math.abs(e.deltaX)<=Math.abs(e.deltaY),s=n||i?e.deltaY:e.deltaX;for(let r=0;r<t.length;r++){const l=t[r];if(ut(l,i))return i?s<0&&l.scrollTop===0?!0:s>0&&l.scrollTop+l.clientHeight===l.scrollHeight:s<0&&l.scrollLeft===0?!0:s>0&&l.scrollLeft+l.clientWidth===l.scrollWidth}return!0}function se(e){e.target===document&&(document.scrollingElement.scrollTop=document.scrollingElement.scrollTop)}function E(e){M!==!0&&(M=!0,requestAnimationFrame(()=>{M=!1;const{height:t}=e.target,{clientHeight:n,scrollTop:i}=document.scrollingElement;(P===void 0||t!==window.innerHeight)&&(P=n-t,document.scrollingElement.scrollTop=i),i>P&&(document.scrollingElement.scrollTop-=Math.ceil((i-P)/8))}))}function le(e){const t=document.body,n=window.visualViewport!==void 0;if(e==="add"){const{overflowY:i,overflowX:s}=window.getComputedStyle(t);H=rt(window),B=at(window),ne=t.style.left,ie=t.style.top,t.style.left=`-${H}px`,t.style.top=`-${B}px`,s!=="hidden"&&(s==="scroll"||t.scrollWidth>window.innerWidth)&&t.classList.add("q-body--force-scrollbar-x"),i!=="hidden"&&(i==="scroll"||t.scrollHeight>window.innerHeight)&&t.classList.add("q-body--force-scrollbar-y"),t.classList.add("q-body--prevent-scroll"),document.qScrollPrevented=!0,a.is.ios===!0&&(n===!0?(window.scrollTo(0,0),window.visualViewport.addEventListener("resize",E,v.passiveCapture),window.visualViewport.addEventListener("scroll",E,v.passiveCapture),window.scrollTo(0,0)):window.addEventListener("scroll",se,v.passiveCapture))}a.is.desktop===!0&&a.is.mac===!0&&window[`${e}EventListener`]("wheel",gt,v.notPassive),e==="remove"&&(a.is.ios===!0&&(n===!0?(window.visualViewport.removeEventListener("resize",E,v.passiveCapture),window.visualViewport.removeEventListener("scroll",E,v.passiveCapture)):window.removeEventListener("scroll",se,v.passiveCapture)),t.classList.remove("q-body--prevent-scroll"),t.classList.remove("q-body--force-scrollbar-x"),t.classList.remove("q-body--force-scrollbar-y"),document.qScrollPrevented=!1,t.style.left=ne,t.style.top=ie,window.scrollTo(H,B),P=void 0)}function yt(e){let t="add";if(e===!0){if(b++,y!==void 0){clearTimeout(y),y=void 0;return}if(b>1)return}else{if(b===0||(b--,b>0))return;if(t="remove",a.is.ios===!0&&a.is.nativeMobile===!0){clearTimeout(y),y=setTimeout(()=>{le(t),y=void 0},100);return}}le(t)}function xt(){let e;return{preventBodyScroll(t){t!==e&&(e!==void 0||t===!0)&&(e=t,yt(t))}}}export{qt as Q,xt as a,kt as b,oe as c,ht as d,vt as e,Ct as n,mt as r,Lt as u};
